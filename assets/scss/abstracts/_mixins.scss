// ==========================================================================
// ABSTRACTS: MIXINS
// ==========================================================================
// Reusable patterns and utilities
// Following DRY principles for maintainable code

@use 'sass:map';
@use 'sass:color';
@use 'variables' as *;

// --------------------------------------------------------------------------
// RESPONSIVE BREAKPOINTS
// --------------------------------------------------------------------------
// Mobile-first approach: styles apply from breakpoint and up

/// Generates a media query for the given breakpoint
/// @param {String} $breakpoint - Breakpoint name from $breakpoints map
/// @example scss
///   @include respond-to('md') {
///     font-size: 1.25rem;
///   }
@mixin respond-to($breakpoint) {
  @if map.has-key($breakpoints, $breakpoint) {
    @media (min-width: map.get($breakpoints, $breakpoint)) {
      @content;
    }
  } @else {
    @warn "Breakpoint '#{$breakpoint}' not found in $breakpoints map.";
  }
}

/// Generates a max-width media query (desktop-first)
/// @param {String} $breakpoint - Breakpoint name from $breakpoints map
@mixin respond-until($breakpoint) {
  @if map.has-key($breakpoints, $breakpoint) {
    @media (max-width: #{map.get($breakpoints, $breakpoint) - 1px}) {
      @content;
    }
  } @else {
    @warn "Breakpoint '#{$breakpoint}' not found in $breakpoints map.";
  }
}

// --------------------------------------------------------------------------
// TYPOGRAPHY
// --------------------------------------------------------------------------

/// Apply font smoothing for better rendering
@mixin font-smoothing {
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

/// Truncate text with ellipsis
@mixin truncate {
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

/// Line clamp for multi-line truncation
/// @param {Number} $lines - Number of lines to show
@mixin line-clamp($lines: 2) {
  display: -webkit-box;
  -webkit-line-clamp: $lines;
  -webkit-box-orient: vertical;
  overflow: hidden;
}

// --------------------------------------------------------------------------
// LAYOUT
// --------------------------------------------------------------------------

/// Flexbox centering (both axes)
@mixin flex-center {
  display: flex;
  align-items: center;
  justify-content: center;
}

/// Flexbox vertical centering
@mixin flex-align-center {
  display: flex;
  align-items: center;
}

/// Flexbox with gap
/// @param {Length} $gap - Gap between items
@mixin flex-gap($gap: $spacing-4) {
  display: flex;
  gap: $gap;
}

/// Absolute positioning fill parent
@mixin absolute-fill {
  position: absolute;
  inset: 0;
}

/// Fixed positioning fill viewport
@mixin fixed-fill {
  position: fixed;
  inset: 0;
}

// --------------------------------------------------------------------------
// VISUAL EFFECTS
// --------------------------------------------------------------------------

/// Smooth transitions
/// @param {String} $properties - CSS properties to transition
/// @param {Duration} $duration - Transition duration
/// @param {String} $timing - Timing function
@mixin transition(
  $properties: all,
  $duration: $transition-duration-base,
  $timing: $transition-timing-default
) {
  transition: $properties $duration $timing;
}

/// Focus ring for accessibility
/// @param {Color} $color - Ring color
@mixin focus-ring($color: $accent) {
  outline: 2px solid $color;
  outline-offset: 2px;
}

/// Glass morphism effect
@mixin glass-morphism($bg-opacity: 0.7) {
  backdrop-filter: blur(24px);
  background-color: color.change(#fff, $alpha: $bg-opacity);
}

// --------------------------------------------------------------------------
// ACCESSIBILITY
// --------------------------------------------------------------------------

/// Visually hidden but accessible to screen readers
@mixin visually-hidden {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  // stylelint-disable-next-line property-no-vendor-prefix, value-no-vendor-prefix, property-no-deprecated
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border: 0;
}

/// Undo visually-hidden
@mixin visually-visible {
  position: static;
  width: auto;
  height: auto;
  padding: 0;
  margin: 0;
  overflow: visible;
  // stylelint-disable-next-line property-no-deprecated
  clip: auto;
  white-space: normal;
}

// --------------------------------------------------------------------------
// DARK MODE
// --------------------------------------------------------------------------

/// Dark mode styles
/// Uses parent .dark class selector pattern
@mixin dark-mode {
  .dark & {
    @content;
  }
}

/// Combined light and dark mode styles
/// @param {String} $property - CSS property
/// @param {*} $light-value - Value for light mode
/// @param {*} $dark-value - Value for dark mode
@mixin themed($property, $light-value, $dark-value) {
  #{$property}: $light-value;

  @include dark-mode {
    #{$property}: $dark-value;
  }
}

// --------------------------------------------------------------------------
// PSEUDO ELEMENTS
// --------------------------------------------------------------------------

/// Create pseudo element with common defaults
/// @param {String} $content - Content value
@mixin pseudo($content: '') {
  content: $content;
  display: block;
}
